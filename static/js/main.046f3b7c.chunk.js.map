{"version":3,"sources":["LineChart.module.css","utils.js","Node.js","constants.js","Graph.js","LineChart.js","SimulationSettings.js","simulation/markov.js","simulation/grid.js","simulation/index.js","App.js","serviceWorker.js","index.js","App.module.css","SimulationSettings.module.css","Graph.module.css"],"names":["module","exports","randomSample","array","size","r","temp","length","i","end","swaps","Math","floor","random","push","sample","slice","pop","shuffle","temporaryValue","randomIndex","currentIndex","weightedRandom","spec","sum","prob","value","padding","max","padded","min","distance","source","target","sqrt","pow","x","y","noop","ICONS","house","flag","Node","layout","node","width","height","type","venue","onNodeClick","position","id","transform","classes","classNames","styles","susceptible","state","sick","recovered","dead","locked","key","className","onClick","fontSize","stroke","fill","strokeWidth","Graph","props","handleTick","bind","setCurrent","current","nodes","reduce","prev","acc","this","runForceSimulation","simulation","on","nextProps","tick","updateForceSimulation","alpha","restart","force","links","edges","forceSimulation","forceLink","forceCollide","iterations","radius","updates","map","setState","nodeId","ref","svgRef","style","shapeRendering","index","Component","defaultProps","buildPolyLineString","points","xMultipier","yMultipier","maxXEntries","concat","join","LineChart","xOffset","yOffset","data","maxYPoint","maxYRange","scaleY","labelY","lineChart","color","labelX","SimulationSettings","simulationState","onSettingChange","onRestartButtonClick","container","form","onChange","initialSickAgents","agentsPerHouse","houses","busStations","hospitals","supermarkets","temples","footer","SIR_TRANSITION_STATE","DISEASE_SPREAD_TRANSITION","getNextMarkovStateForAgent","agent","transitionMap","location","split","agentLocation","applyFixedNodeGrid","nodesToAlign","filter","count","fetch","then","response","json","console","log","JSON","stringify","features","properties","region_un","admin","fx","geometry","coordinates","fy","iso_a2","VENUES","name","members","isRoot","VENUE_TRANSITIONS","getInitialGraph","forEach","alignment","nodeIndex","venueId","j","agentId","base","sickAgents","nextSimulationTick","find","nextMarkovState","moveAgent","fellow","applySIRModel","targetNode","sourceNode","edge","INITIAL_SIMULATION_STATE","INITIAL_GRAPH","App","useState","setSimulationState","setNodes","setEdges","historicalSickCount","setHistoricalSickCount","historicalRecoveredCount","setHistoricalRecoveredCount","historicalDeadCount","setHistoricalDeadCount","loading","setLoading","graphRef","useRef","callback","delay","savedCallback","useEffect","setInterval","clearInterval","useInterval","header","href","textDecoration","samples","sampleSusceptible","sampleInfected","sampleRecovered","round","section","stats","population","simulationSettings","simulationInfo","event","pageInfo","display","textAlign","data-ad-layout","data-ad-format","data-ad-client","data-ad-slot","marginBottom","Boolean","window","hostname","match","ReactDOM","render","StrictMode","document","getElementById","navigator","serviceWorker","ready","registration","unregister","catch","error","message"],"mappings":"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","file":"static/js/main.046f3b7c.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"lineChart\":\"LineChart_lineChart__1YIFO\",\"labelY\":\"LineChart_labelY__3CF0E\",\"labelX\":\"LineChart_labelX__L30Wm\"};","import { COLORS as colors } from './constants';\nimport React, { useState, useEffect, useRef } from 'react';\n\nexport function useInterval(callback, delay) {\n  // https://overreacted.io/making-setinterval-declarative-with-react-hooks/\n  // danke, dan\n  const savedCallback = useRef();\n\n  // Remember the latest callback.\n  useEffect(() => {\n    savedCallback.current = callback;\n  }, [callback]);\n\n  // Set up the interval.\n  useEffect(() => {\n    function tick() {\n      savedCallback.current();\n    }\n    if (delay !== null) {\n      let id = setInterval(tick, delay);\n      return () => clearInterval(id);\n    }\n  }, [delay]);\n}\n\nfunction getRandom(length) { return Math.floor(Math.random() * length); }\n\nexport function randomSample(array, size) {\n  // https://stackoverflow.com/a/37835673\n  var r, i = array.length, end = i - size, temp, swaps = randomSample.swaps;\n\n  while (i-- > end) {\n      r = getRandom(i + 1);\n      temp = array[r];\n      array[r] = array[i];\n      array[i] = temp;\n      swaps.push(i);\n      swaps.push(r);\n  }\n\n  var sample = array.slice(end);\n\n  while(size--) {\n      i = swaps.pop();\n      r = swaps.pop();\n      temp = array[i];\n      array[i] = array[r];\n      array[r] = temp;\n  }\n\n  return sample;\n}\nrandomSample.swaps = [];\n\nexport function randomChoice(array) {\n  return array[Math.floor(Math.random() * array.length)]\n}\n\nexport function shuffle(array) {\n  // https://stackoverflow.com/a/2450976\n  var currentIndex = array.length, temporaryValue, randomIndex;\n\n  // While there remain elements to shuffle...\n  while (0 !== currentIndex) {\n\n    // Pick a remaining element...\n    randomIndex = Math.floor(Math.random() * currentIndex);\n    currentIndex -= 1;\n\n    // And swap it with the current element.\n    temporaryValue = array[currentIndex];\n    array[currentIndex] = array[randomIndex];\n    array[randomIndex] = temporaryValue;\n  }\n\n  return array;\n}\n\nexport function weightedRandom(spec) {\n  const random = Math.random();\n  let sum = .0; \n\n  for (var i in spec) {\n    const [prob, value] = spec[i];\n    sum += prob;\n    if (random <= sum) {\n      return value;\n    };\n  }\n};\n\nexport function rangeBetween(min, max) {\n  return Math.random() * (max - min) + min;\n}\n\nexport function shade(value) {\n  let sum = 0;\n\n  for (var i in colors) {\n    const color = colors[i];\n    if (value <= sum) {\n      return color;\n    };\n\n    sum += 1 / colors.length;\n  }\n\n  return colors[colors.length - 1];\n}\n\nexport function padding(value, max, padded) {\n  return Math.min(Math.max(padded, value), max - 50);\n}\n\nexport function distance(source, target) {\n    return Math.sqrt(Math.pow(target.x - source.x, 2) + Math.pow(target.y - source.y, 2))\n}\n","import React, { Component } from \"react\";\nimport classNames from \"classnames\";\n\nimport styles from \"./Graph.module.css\";\nimport { padding, shade } from \"./utils\";\nimport { VENUE, SUSCEPTIBLE, SICK, RECOVERED, DEAD } from \"./constants\";\n\nimport flag from 'country-code-emoji';\n\nfunction noop() {}\n\nconst ICONS = {\n  house: \"ðŸ \",\n  \"AL\": flag(\"AL\"),\n  \"AX\": flag(\"AX\"),\n  \"AD\": flag(\"AD\"),\n  \"AT\": flag(\"AT\"),\n  \"BE\": flag(\"BE\"),\n  \"BG\": flag(\"BG\"),\n  \"BA\": flag(\"BA\"),\n  \"BY\": flag(\"BY\"),\n  \"CH\": flag(\"CH\"),\n  \"CZ\": flag(\"CZ\"),\n  \"DE\": flag(\"DE\"),\n  \"DK\": flag(\"DK\"),\n  \"ES\": flag(\"ES\"),\n  \"EE\": flag(\"EE\"),\n  \"FI\": flag(\"FI\"),\n  \"FR\": flag(\"FR\"),\n  \"GB\": flag(\"GB\"),\n  \"GG\": flag(\"GG\"),\n  \"GR\": flag(\"GR\"),\n  \"HR\": flag(\"HR\"),\n  \"HU\": flag(\"HU\"),\n  \"IM\": flag(\"IM\"),\n  \"IE\": flag(\"IE\"),\n  \"IS\": flag(\"IS\"),\n  \"IT\": flag(\"IT\"),\n  \"JE\": flag(\"JE\"),\n  \"XK\": flag(\"XK\"), // Kosovo we feel your pain, too.\n  \"LI\": flag(\"LI\"),\n  \"LT\": flag(\"LT\"),\n  \"LU\": flag(\"LU\"),\n  \"LV\": flag(\"LV\"),\n  \"MC\": flag(\"MC\"),\n  \"MD\": flag(\"MD\"),\n  \"MK\": flag(\"MK\"),\n  \"MT\": flag(\"MT\"),\n  \"ME\": flag(\"ME\"),\n  \"NL\": flag(\"NL\"),\n  \"NO\": flag(\"NO\"),\n  \"PL\": flag(\"PL\"),\n  \"PT\": flag(\"PT\"),\n  \"RO\": flag(\"RO\"),\n  \"SM\": flag(\"SM\"),\n  \"RS\": flag(\"RS\"),\n  \"SK\": flag(\"SK\"),\n  \"SI\": flag(\"SI\"),\n  \"SE\": flag(\"SE\"),\n  \"UA\": flag(\"UA\"),\n  \"VA\": flag(\"VA\"),\n};\n\n// TODO: Elegant solution for this one?\n//const ICONS = ['AL', 'NL', 'GB'].forEach(x => x, flag(x));\n\nexport default function Node({\n  layout,\n  node,\n  width,\n  height,\n  type,\n  venue,\n  onNodeClick = noop\n}) {\n  const position = layout[node.id];\n  const transform = `translate(\n    ${padding(position.x, width, 7)},\n    ${padding(position.y, height, 30)}\n  )`;\n\n  const classes = classNames({\n    [styles.node]: true,\n    [styles[type]]: true,\n    [styles[venue]]: true,\n    [styles.susceptible]: node.state === SUSCEPTIBLE,\n    [styles.sick]: node.state === SICK,\n    [styles.recovered]: node.state === RECOVERED,\n    [styles.dead]: node.state === DEAD,\n    [styles.locked]: node.locked\n  });\n\n  return (\n    <g key={`${node.id}-Node`} id={node.id} transform={transform}>\n      {node.type === VENUE ? (\n        <text\n          className={classes}\n          onClick={onNodeClick(node.id)}\n          x={-8}\n          y={7}\n          fontSize={16}\n        >\n          {ICONS[node.venue]}\n        </text>\n      ) : node.state === 3 ? (\n        <text onClick={onNodeClick(node.id)} x={-8} y={7} fontSize={16}>\n          ðŸ’€\n        </text>\n      ) : (\n        <circle\n          className={classes}\n          r={5}\n          stroke={0}\n          onClick={onNodeClick(node.id)}\n          fill={\"black\"}\n        />\n      )}\n      {false && node.type === VENUE && (\n        <text fontSize={9} x={-(node.venue.length * 3.1)} y={20} fill={\"black\"}>\n          {node.venue.toUpperCase()}\n        </text>\n      )}\n      {node.locked && (\n        <circle r={40} fill={\"none\"} stroke={\"gray\"} strokeWidth={2} />\n      )}\n    </g>\n  );\n}\n","const VENUE = 'venue';\nconst AGENT = 'agent';\n\nconst SUSCEPTIBLE = 0;\nconst SICK = 1;\nconst RECOVERED = 2;\nconst DEAD = 3;\n\nconst COLORS = ['#ECA6E1','#C28CBE','#9B729C','#76597B','#55415B','#362A3C'];\nconst FPS = 400;\n\nexport {\n  SUSCEPTIBLE, SICK, RECOVERED, DEAD,\n  VENUE, AGENT,\n  COLORS,\n  FPS,\n};\n","import React, { Component } from \"react\";\n\nimport {\n  forceSimulation,\n  forceLink,\n  forceCollide\n} from \"d3-force\";\n\nimport Node from \"./Node\";\n\nexport default class Graph extends Component {\n  constructor(props) {\n    super(props);\n\n    this.handleTick = this.handleTick.bind(this);\n    this.setCurrent = this.setCurrent.bind(this);\n\n    this.state = {\n      current: null,\n      layout: props.nodes.reduce(\n        (prev, acc) => (\n          (prev[acc.id] = {\n            x: 0,\n            y: 0\n          }),\n          prev\n        ),\n        {}\n      )\n    };\n  }\n\n  componentDidMount() {}\n\n  componentWillMount() {\n    this.runForceSimulation();\n\n    this.simulation.on(\"tick\", this.handleTick);\n  }\n\n  componentWillUnmount() {\n    this.simulation.on(\"tick\", null);\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if (this.props.tick !== nextProps.tick) {\n      this.updateForceSimulation();\n    }\n  }\n\n  updateForceSimulation() {\n    this.simulation.alpha(0.2).restart();\n    this.simulation.nodes(this.props.nodes);\n    this.simulation.force(\"link\").links(this.props.edges);\n  }\n\n  shouldComponentUpdate(props, nextProps) {\n    return props.tick !== nextProps.tick;\n  }\n\n  runForceSimulation() {\n    const { nodes, edges } = this.props;\n\n    const simulation = (this.simulation = forceSimulation(nodes)\n      .force(\n        \"link\",\n        forceLink().id(node => node.id)\n      )\n      .force(\n        \"collide\",\n        forceCollide(() => 1)\n          .iterations(1)\n          .radius(9)\n      ));\n\n    simulation\n      .force(\"link\")\n      .links(edges)\n      .distance(25);\n  }\n\n  handleTick() {\n    const { simulation } = this;\n    const { layout } = this.state;\n    let updates = {};\n\n    simulation.nodes().map(node => {\n      updates[node.id] = node;\n    });\n\n    this.setState({\n      layout: {\n        ...layout,\n        ...updates\n      }\n    });\n  }\n\n  setCurrent(nodeId) {\n    return () => {\n      this.setState({\n        current: nodeId\n      });\n    };\n  }\n\n  render() {\n    const { nodes, edges, width, height, onNodeClick } = this.props;\n    const { layout, current } = this.state;\n    return (\n      <svg\n        width={width}\n        ref={ref => (this.svgRef = ref)}\n        height={height}\n        style={{\n          shapeRendering: \"geometricPrecision\"\n        }}\n      >\n        {nodes.map((node, index) => (\n          <Node\n            key={index}\n            node={node}\n            layout={layout}\n            current={current}\n            width={width}\n            height={height}\n            onNodeClick={onNodeClick}\n            {...node}\n          />\n        ))}\n      </svg>\n    );\n  }\n}\n\nGraph.defaultProps = {\n  width: 900,\n  height: 600,\n  nodes: [],\n  edges: []\n};\n","import React from \"react\";\n\nimport styles from \"./LineChart.module.css\";\n\nfunction buildPolyLineString(points, xMultipier, yMultipier, maxXEntries) {\n  return points\n    .slice(Math.max(points.length - maxXEntries, 0))\n    .reduce((acc, current, i) => {\n      return acc.concat(`${i * xMultipier}, ${-(current * yMultipier)}`);\n    }, [])\n    .join(\" \");\n}\n\nexport default function LineChart({\n  width,\n  height,\n  xOffset = 10,\n  yOffset = 17,\n  data = [],\n  maxXEntries = 100\n}) {\n  const maxYPoint = height - 50;\n  const maxYRange = Math.max(\n    maxYPoint,\n    ...data.reduce((prev, { points }) => prev.concat(points), [])\n  );\n\n  const yMultipier = 1;\n  const xMultipier = 2.5;\n  const scaleY = maxYPoint / maxYRange;\n\n  return (\n    <>\n      <span className={styles.labelY}>population â†’</span>\n      <svg className={styles.lineChart} width={width} height={height}>\n        <g\n          transform={`scale(1, ${scaleY}), translate(0, ${(height - 30) /\n            scaleY})`}\n        >\n          {data.map(({ points, color }, i) => (\n            <g\n              key={`line-${i}`}\n              transform={`translate(${xOffset + 5}, ${yMultipier + yOffset})`}\n            >\n              <polyline\n                points={buildPolyLineString(\n                  points,\n                  xMultipier,\n                  yMultipier,\n                  maxXEntries\n                )}\n                stroke={color}\n                fill=\"transparent\"\n                strokeWidth={2}\n              />\n            </g>\n          ))}\n        </g>\n      </svg>\n      <span className={styles.labelX}>days since the first case â†’</span>\n    </>\n  );\n}\n","import React from 'react';\n\nimport styles from './SimulationSettings.module.css';\n\nexport default function SimulationSettings({\n  simulationState,\n  onSettingChange,\n  onRestartButtonClick,\n}) {\n  return (\n    <div className={ styles.container }>\n      <div className={ styles.form }>\n      <label>\n        Initial sick agents<br />\n        <input\n          type={ 'range' }\n          onChange={ onSettingChange('initialSickAgents') }\n          value={ simulationState.initialSickAgents }\n          min={ 0 }\n          max={ 10 }\n        /> <span className={ styles.value }>{ simulationState.initialSickAgents }</span>\n      </label>\n      <label>\n        Agents per building <br />\n        <input\n          type={ 'range' }\n          onChange={ onSettingChange('agentsPerHouse') }\n          value={ simulationState.agentsPerHouse }\n          min={ 1 }\n          max={ 10 }\n        /> <span className={ styles.value }>{ simulationState.agentsPerHouse }</span>\n      </label>\n      <label>\n        Houses <br />\n        <input\n          type={ 'range' }\n          onChange={ onSettingChange('houses') }\n          value={ simulationState.houses }\n          min={ 0 }\n          max={ 100 }\n        /> <span className={ styles.value }>{ simulationState.houses }</span>\n      </label>\n      <label>\n        Bus stations <br />\n        <input\n          type={ 'range' }\n          onChange={ onSettingChange('busStations') }\n          value={ simulationState.busStations }\n          min={ 0 }\n          max={ 10 }\n        /> <span className={ styles.value }>{ simulationState.busStations }</span>\n      </label>\n      <label>\n        Hospitals <br />\n        <input\n          type={ 'range' }\n          onChange={ onSettingChange('hospitals') }\n          value={ simulationState.hospitals }\n          min={ 0 }\n          max={ 10 }\n        /> <span className={ styles.value }>{ simulationState.hospitals }</span>\n      </label>\n      <label>\n        Supermarkets <br />\n        <input\n          type={ 'range' }\n          onChange={ onSettingChange('supermarkets') }\n          value={ simulationState.supermarkets }\n          min={ 0 }\n          max={ 10 }\n        /> <span className={ styles.value }>{ simulationState.supermarkets }</span>\n      </label>\n      <label>\n        Temples <br />\n        <input\n          type={ 'range' }\n          onChange={ onSettingChange('temples') }\n          value={ simulationState.temples }\n          min={ 0 }\n          max={ 10 }\n        /> <span className={ styles.value }>{ simulationState.temples }</span>\n      </label>\n      </div>\n\n      <div className={ styles.footer }>\n        <button onClick={ onRestartButtonClick }>Restart the simulation</button>\n      </div>\n    </div>\n  );\n}\n","import {\n  SUSCEPTIBLE, SICK, RECOVERED, DEAD,\n} from '../constants';\n\nimport { randomChoice, weightedRandom } from '../utils';\n\nexport const STAY = 'stay';\nexport const BASE = 'base';\n\nconst SIR_TRANSITION_STATE = {\n  [SUSCEPTIBLE]: [\n    [1, SUSCEPTIBLE],\n  ],\n  [RECOVERED]: [\n    [1, RECOVERED],\n  ],\n  [SICK]: [\n    [0.995, SICK],\n    [0.004, RECOVERED],\n    [0.001, DEAD],\n  ],\n  [DEAD]: [\n    [1, DEAD],\n  ],\n};\n\nconst DISEASE_SPREAD_TRANSITION = {\n  [SUSCEPTIBLE]: [\n    [0.3, SICK],\n    [0.7, SUSCEPTIBLE],\n  ],\n  [RECOVERED]: [\n    [1, RECOVERED],\n  ],\n  [SICK]: [\n    [1, SICK],\n  ],\n  [DEAD]: [\n    [1, DEAD],\n  ],\n};\n\nexport function getNextMarkovStateForAgent(agent, transitionMap) {\n  const [agentLocation] = agent.location.split('-');\n\n  if (agentLocation === 'house' && Math.random() < 0.9) {\n    return STAY;\n  }\n\n  const map = transitionMap[agentLocation];\n\n  return randomChoice(map);\n}\n\nexport function applySIRModel(nodes, edges) {\n  for (const node of nodes) {\n    if (node.type !== 'agent') {\n      continue;\n    }\n\n    const location = nodes.find(({ id }) => node.location === id);\n    const fellows = edges\n      .filter(({ target }) => target.id === location.id)\n      .map(({ source }) => source);\n\n    fellows.forEach(\n      (fellow) => {\n        if (fellow.id === node.id) {\n          return;\n        }\n\n        if (node.state === SICK) {\n          fellow.state = weightedRandom(DISEASE_SPREAD_TRANSITION[fellow.state]);\n        }\n\n        fellow.state = weightedRandom(SIR_TRANSITION_STATE[fellow.state]);\n      }\n    )\n  }\n}\n","import { shuffle } from '../utils';\n\nexport function applyFixedNodeGrid(nodes, height = 600) {\n  shuffle(nodes);\n\n  const gridSize = 100;\n  const nodesToAlign = nodes.filter(({ type }) => type === 'venue');\n  const count = nodesToAlign.length;\n\n  fetch('https://raw.githubusercontent.com/eusim/coronavirus-simulation/master/data/country_centroids_az8.json')\n    .then((response) => {\n      return response.json();\n    })\n    .then((data) => {\n      console.log(JSON.stringify(data));\n\n      var venue = 0;\n      for (var i = 0; (i < data.features.length && venue < count); i++) {\n        if (data.features[i].properties.region_un === 'Europe'\n          && (data.features[i].properties.type === 'Country'\n          || data.features[i].properties.type === 'Sovereign country')\n          && data.features[i].properties.admin !== 'Russia') {\n          const node = nodesToAlign[venue];\n\n          node.fx = data.features[i].geometry.coordinates[0] * 14 + 300;\n          node.fy = - data.features[i].geometry.coordinates[1] * 14 + 1100;\n\n          // TODO: Kosovo, we feel your pain\n          if (data.features[i].properties.iso_a2 == -99) {\n            data.features[i].properties.iso_a2 = \"XK\";\n          }\n          node.venue = data.features[i].properties.iso_a2;\n\n          venue++;\n        }\n      }\n    });\n\n  return nodes;\n}\n","import { randomSample, distance } from '../utils';\n\nimport { AGENT, SUSCEPTIBLE, SICK, DEAD } from '../constants';\n\nimport { getNextMarkovStateForAgent, STAY, BASE, applySIRModel } from './markov';\nimport { applyFixedNodeGrid } from './grid';\n\nconst VENUES = [\n  {\n    name: 'house',\n    members: simulationState => simulationState.agentsPerHouse,\n    isRoot: true,\n    count: simulationState => simulationState.houses,\n  }\n];\n\nconst VENUE_TRANSITIONS = {\n  'house': ['house', 'house', 'house', 'house', 'house', 'house', 'house', 'house']\n};\n\nfunction getInitialGraph(simulationState) {\n  const nodes = [];\n  const edges = [];\n\n  VENUES.forEach(({\n    name,\n    members,\n    isRoot,\n    count,\n    alignment,\n  }) => {\n    for (let i = 0, nodeIndex = 0; i < count(simulationState); i++, nodeIndex++) {\n      const venueId = `${name}-${i}`;\n      const venueIndex = nodeIndex;\n      nodes.push({\n        type: 'venue',\n        venue: name,\n        id: venueId,\n        size: 1,\n      });\n\n      if (!members) {\n        continue;\n      }\n\n      for (var j = 0; j < members(simulationState); j++, nodeIndex++) {\n        const agentId = `${name}-${i}-${j}`;\n        nodes.push({\n          type: 'agent',\n          location: venueId,\n          base: venueId,\n          id: agentId,\n          size: 1,\n          state: SUSCEPTIBLE,\n        });\n        edges.push({\n          'source': agentId,\n          'target': venueId,\n        });\n      }\n    }\n  });\n\n  const sickAgents = randomSample(\n    nodes.filter(({ type }) => type === 'agent'),\n    simulationState.initialSickAgents\n  );\n\n  for (const agent of sickAgents) {\n    agent.state = SICK;\n  }\n\n  return ({\n    nodes: applyFixedNodeGrid(nodes),\n    edges,\n  });\n}\n\nfunction nextSimulationTick(state, nodes, edges) {\n  const rootVenue = VENUES.find(({ isRoot }) => isRoot);\n\n  nodes\n    .filter(\n      ({ type }) => type === AGENT\n    )\n    .forEach(\n      (agent, i) => {\n        const nextMarkovState = getNextMarkovStateForAgent(agent, VENUE_TRANSITIONS);\n        const [agentLocation] = agent.location.split('-')\n\n        if (\n          agentLocation === nextMarkovState ||\n          (nextMarkovState === BASE && agent.location === agent.base) ||\n          nextMarkovState === STAY\n        ) {\n          return;\n        } else if (agent.state === DEAD) {\n          return;\n        } else if (nextMarkovState === BASE) {\n          moveAgent(\n            nodes,\n            edges,\n            agent,\n            nodes.find(({ id }) => id === agent.base)\n          );\n        } else {\n          moveAgent(\n            nodes,\n            edges,\n            agent,\n            findClosestNode(agent, nodes.filter(({ venue }) => venue === nextMarkovState))\n          );\n        };\n\n      }\n    );\n\n\n  nodes = applySIRModel(nodes, edges);\n\n  return {\n    nodes: nodes,\n    edges: edges,\n    state: { ...state, tick: state.tick + 1},\n  }\n}\n\nfunction moveAgent(nodes, edges, agent, targetNode) {\n  const sourceNode = nodes.find(({ id }) => id === agent.location);\n\n  if (targetNode.locked || sourceNode.locked) {\n    return;\n  }\n\n  const newEdges = edges.map((edge) => {\n    if (edge.source.id === agent.id) {\n      edge.target = targetNode;\n    }\n  });\n\n  agent.location = targetNode.id;\n}\n\nfunction findClosestNode(source, targets) {\n  const closest = targets.reduce(\n    (prev, current) => distance(source, current) < distance(source, prev) ? current : prev\n  );\n\n  return closest;\n}\n\nexport {\n  VENUES,\n  VENUE_TRANSITIONS,\n  getInitialGraph,\n  nextSimulationTick,\n};\n","import React, { useEffect, useState, useRef } from \"react\";\n\nimport styles from \"./App.module.css\";\nimport Graph from \"./Graph\";\nimport LineChart from \"./LineChart\";\nimport SimulationSettings from \"./SimulationSettings\";\nimport { SICK, RECOVERED, DEAD } from \"./constants\";\nimport { useInterval, randomChoice } from \"./utils\";\nimport { nextSimulationTick, getInitialGraph } from \"./simulation\";\n\nconst INITIAL_SIMULATION_STATE = {\n  tick: 0,\n  agentsPerHouse: 9,\n  houses: 42,\n  initialSickAgents: 1,\n};\n\n// Setup initial graph containing venues and agents\nconst INITIAL_GRAPH = getInitialGraph(INITIAL_SIMULATION_STATE);\n\nfunction App() {\n  const [simulationState, setSimulationState] = useState(\n    INITIAL_SIMULATION_STATE\n  );\n  const [nodes, setNodes] = useState(INITIAL_GRAPH.nodes);\n  const [edges, setEdges] = useState(INITIAL_GRAPH.edges);\n  const [historicalSickCount, setHistoricalSickCount] = useState([]);\n  const [historicalRecoveredCount, setHistoricalRecoveredCount] = useState([]);\n  const [historicalDeadCount, setHistoricalDeadCount] = useState([]);\n  const [loading, setLoading] = useState(true);\n\n  const graphRef = useRef(null);\n\n  useInterval(() => {\n    if (loading) {\n      return;\n    }\n\n    const { nodes: _nodes, edges: _edges, state } = nextSimulationTick(\n      simulationState,\n      nodes,\n      edges\n    );\n\n    setSimulationState(state);\n\n    // Setup for graph in the bottom right\n    setHistoricalSickCount(\n      historicalSickCount.concat(\n        nodes.filter(({ state }) => state === SICK).length\n      )\n    );\n\n    setHistoricalRecoveredCount(\n      historicalRecoveredCount.concat(\n        nodes.filter(({ state }) => state === RECOVERED).length\n      )\n    );\n\n    setHistoricalDeadCount(\n      historicalDeadCount.concat(\n        nodes.filter(({ state }) => state === DEAD).length\n      )\n    );\n  }, 1000);\n\n  useEffect(() => {\n    setLoading(false);\n  }, [loading]);\n\n\n  // Quarantine\n  const onNodeClick = (nodeId) => {\n    return () => {\n      const node = nodes.find(({ id }) => nodeId === id);\n      if (node.type !== \"venue\") {\n        return;\n      }\n      node.locked = !node.locked;\n    };\n  };\n\n  const onSettingChange = (key) => (event) => {\n    setSimulationState({ ...simulationState, [key]: event.target.value });\n  };\n\n  const onRestartButtonClick = () => {\n    const { nodes, edges } = getInitialGraph(simulationState);\n    setLoading(true);\n    setNodes(nodes);\n    setEdges(edges);\n    setHistoricalDeadCount([]);\n    setHistoricalRecoveredCount([]);\n    setHistoricalSickCount([]);\n    setSimulationState({ ...simulationState, tick: 0 });\n  };\n\n  return (\n    <div className={styles.container}>\n      <div className={styles.header}>\n        <a href=\"/\" style={{ color: 'gray', textDecoration: 'none' }}>â†µ Other simulations</a>\n        <h3>Simulating coronavirus with the SIR model</h3>\n        <h2>An experiment to analyse how a virus spread over a community</h2>\n      </div>\n      <div className={styles.simulation}>\n        <div className={styles.samples}>\n          <span className={styles.sampleSusceptible}>Susceptible</span>\n          <span className={styles.sampleInfected}>Infected</span>\n          <span className={styles.sampleRecovered}>Recovered</span>\n          <i>Click on a building to lock it (quarantine)</i>\n        </div>\n        {!loading && (\n          <Graph\n            width={\n              Math.round(\n                nodes.filter(({ type }) => type === \"venue\").length / 6\n              ) * 110\n            }\n            height={700}\n            tick={simulationState.tick}\n            nodes={nodes}\n            edges={edges}\n            onNodeClick={onNodeClick}\n            ref={graphRef}\n          />\n        )}\n      </div>\n      <div className={styles.section}>\n        <div className={styles.stats}>\n          <h3>Stats</h3>\n          <div className={styles.population}>\n            POPULATION: {nodes.filter(({ type }) => type === \"agent\").length}{\" \"}\n            <br />\n            DEAD: {nodes.filter(({ state }) => state === DEAD).length} <br />\n            RECOVERED: {\n              nodes.filter(({ state }) => state === RECOVERED).length\n            }{\" \"}\n            <br />\n            SICK: {nodes.filter(({ state }) => state === SICK).length} <br />\n          </div>\n          <LineChart\n            width={300}\n            height={270}\n            data={[\n              { color: \"red\", points: historicalSickCount },\n              { color: \"green\", points: historicalRecoveredCount },\n              { color: \"black\", points: historicalDeadCount },\n            ]}\n          />\n        </div>\n        <div className={styles.simulationSettings}>\n          <h3>Settings</h3>\n          <div className={styles.simulationInfo}>\n            Click on a building on the map to make it quarantined.\n          </div>\n          <SimulationSettings\n            simulationState={simulationState}\n            onSettingChange={onSettingChange}\n            onRestartButtonClick={onRestartButtonClick}\n          />\n        </div>\n        \n      </div>\n      <div className={styles.pageInfo}>\n      <ins\n          className=\"adsbygoogle\"\n          style={{ display: 'block', textAlign: 'center' }}\n          data-ad-layout=\"in-article\"\n          data-ad-format=\"fluid\"\n          data-ad-client=\"ca-pub-5587173855104127\"\n          data-ad-slot=\"8487596319\"\n        ></ins>\n        <div className={styles.section}>\n          <h1>What is this?</h1>\n          <p>\n            This is a simulation of how a virus spread of the population. The\n            simulation is heavily inspired by the SIR model. SIR is a technique\n            used to simplify the mathematical modelling of infectious disase.\n          </p>\n          <p>\n            In the SIR model, we have three different states of each agent (a\n            person). The first state is\n            <i> SUSCEPTIBLE</i>, second one is <i> SICK</i>, and the last one is\n            <i> RECOVERED</i>. We have also a <i> DEAD</i> state in this\n            simulation.\n          </p>\n          <h1>How does it work?</h1>\n          <p>\n            Every agent starts with the `SUSCEPTIBLE` state in the simulation,\n            except a few of them. Some of the agents are on the `SICK` state at\n            the very beginning. Over the time, sick agents spread the virus to\n            rest of the population and the other agents get sick as well. After\n            the infection, they switch into a recovered or a dead state based on\n            some probabilistic values.\n          </p>\n          <p>\n            The probabilistic values are defined in a markov-chain concept.\n            Markov chain is a stochastic model to describe a sequence of\n            possible events that can occur in the future.\n          </p>\n          <h1>How does a probabilistic model look like?</h1>\n          <p>\n            We're using a markov graph to define a probabilistic transition. We\n            can simply say that markov chain is a graph of all the possible\n            state transitions of an individual node.\n          </p>\n          <h1>I would like to discover more:</h1>\n          <p>\n            This is an MIT-licensed open-source project, you can find the source\n            code on github. Feel free to copy, use or modify it for your own\n            simulations.\n          </p>\n          <p>\n            <a href=\"https://github.com/eusim/coronavirus-simulation\">\n              https://github.com/eusim/coronavirus-simulation\n            </a> which is based on\n            <a href=\"https://twitter.com/fthrkl\">@fthrkl</a>'s\n            <br />\n            <a href=\"https://github.com/fatiherikli/coronavirus-simulation\">\n              https://github.com/fatiherikli/coronavirus-simulation\n            </a>\n          </p>\n\n          <p style={{ marginBottom: \"4em\" }}>\n            Stay safe! <br />{\" \"}\n          </p>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"App_container__1MQN3\",\"header\":\"App_header__3ZZ1n\",\"simulationContainer\":\"App_simulationContainer__23iFm\",\"simulation\":\"App_simulation__1Y9Gr\",\"section\":\"App_section__1OL6S\",\"simulationSettings\":\"App_simulationSettings__txA-R\",\"stats\":\"App_stats__2fMs7\",\"population\":\"App_population__3MVPW\",\"simulationInfo\":\"App_simulationInfo__1KRFk\",\"pageInfo\":\"App_pageInfo__2E9cf\",\"samples\":\"App_samples__2e7V-\",\"sampleSusceptible\":\"App_sampleSusceptible__2olEO\",\"sampleInfected\":\"App_sampleInfected__1l1Pi\",\"sampleRecovered\":\"App_sampleRecovered__33NzV\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"SimulationSettings_container__vY4rL\",\"form\":\"SimulationSettings_form__E6YUW\",\"value\":\"SimulationSettings_value__1sPd7\",\"footer\":\"SimulationSettings_footer__1GRqa\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"node\":\"Graph_node__2LUmU\",\"venue\":\"Graph_venue__1yeeL\",\"hospital\":\"Graph_hospital__2-HM5\",\"teatr\":\"Graph_teatr__3zcOH\",\"station\":\"Graph_station__3oWAU\",\"supermarket\":\"Graph_supermarket__x5o1m\",\"susceptible\":\"Graph_susceptible__2UC5Q\",\"dead\":\"Graph_dead__aGtk-\",\"sick\":\"Graph_sick__2ig0f\",\"recovered\":\"Graph_recovered__3crc2\",\"lockedSymbol\":\"Graph_lockedSymbol__1OEeZ\"};"],"sourceRoot":""}