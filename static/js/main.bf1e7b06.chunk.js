(this.webpackJsonpeusim=this.webpackJsonpeusim||[]).push([[0],{12:function(e,t,a){e.exports={lineChart:"LineChart_lineChart__1YIFO",labelY:"LineChart_labelY__3CF0E",labelX:"LineChart_labelX__L30Wm"}},23:function(e,t,a){e.exports=a(29)},28:function(e,t,a){},29:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),r=a(15),o=a.n(r),c=(a(28),a(2)),s=a(6),l=a(4),u=a(3),m=a.n(u),h=a(16),f=a(17),d=a(10),p=a(19),v=a(21),g=a(13),b=a(18),E=a.n(b),_=a(5),k=a.n(_);function y(e,t){for(var a,n,i,r=e.length,o=r-t,c=y.swaps;r-- >o;)i=r+1,n=e[a=Math.floor(Math.random()*i)],e[a]=e[r],e[r]=n,c.push(r),c.push(a);for(var s=e.slice(o);t--;)r=c.pop(),a=c.pop(),n=e[r],e[r]=e[a],e[a]=n;return s}function S(e){for(var t,a,n=e.length;0!==n;)a=Math.floor(Math.random()*n),t=e[n-=1],e[n]=e[a],e[a]=t;return e}function O(e){var t=Math.random(),a=0;for(var n in e){var i=Object(l.a)(e[n],2),r=i[0],o=i[1];if(t<=(a+=r))return o}}function j(e,t,a){return Math.min(Math.max(a,e),t-50)}function C(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}y.swaps=[];var A=a(1),I=a.n(A);function M(){}var N={house:"\ud83c\udfe0",AL:I()("AL"),AX:I()("AX"),AD:I()("AD"),AT:I()("AT"),BE:I()("BE"),BG:I()("BG"),BA:I()("BA"),BY:I()("BY"),CH:I()("CH"),CZ:I()("CZ"),DE:I()("DE"),DK:I()("DK"),ES:I()("ES"),EE:I()("EE"),FI:I()("FI"),FR:I()("FR"),GB:I()("GB"),GG:I()("GG"),GR:I()("GR"),HR:I()("HR"),HU:I()("HU"),IM:I()("IM"),IE:I()("IE"),IS:I()("IS"),IT:I()("IT"),JE:I()("JE"),XK:I()("XK"),LI:I()("LI"),LT:I()("LT"),LU:I()("LU"),LV:I()("LV"),MC:I()("MC"),MD:I()("MD"),MK:I()("MK"),MT:I()("MT"),ME:I()("ME"),NL:I()("NL"),NO:I()("NO"),PL:I()("PL"),PT:I()("PT"),RO:I()("RO"),SM:I()("SM"),RS:I()("RS"),SK:I()("SK"),SI:I()("SI"),SE:I()("SE"),UA:I()("UA"),VA:I()("VA")};function w(e){var t,a=e.layout,n=e.node,r=e.width,o=e.height,s=e.type,l=e.venue,u=e.onNodeClick,m=void 0===u?M:u,h=a[n.id],f="translate(\n    ".concat(j(h.x,r,7),",\n    ").concat(j(h.y,o,30),"\n  )"),d=E()((t={},Object(c.a)(t,k.a.node,!0),Object(c.a)(t,k.a[s],!0),Object(c.a)(t,k.a[l],!0),Object(c.a)(t,k.a.susceptible,0===n.state),Object(c.a)(t,k.a.sick,1===n.state),Object(c.a)(t,k.a.recovered,2===n.state),Object(c.a)(t,k.a.dead,3===n.state),Object(c.a)(t,k.a.locked,n.locked),t));return i.a.createElement("g",{key:"".concat(n.id,"-Node"),id:n.id,transform:f},"venue"===n.type?i.a.createElement("text",{className:d,onClick:m(n.id),x:-8,y:7,fontSize:16},N[n.venue]):3===n.state?i.a.createElement("text",{onClick:m(n.id),x:-8,y:7,fontSize:16},"\ud83d\udc80"):i.a.createElement("circle",{className:d,r:5,stroke:0,onClick:m(n.id),fill:"black"}),!1,n.locked&&i.a.createElement("circle",{r:40,fill:"none",stroke:"gray",strokeWidth:2}))}var R=function(e){Object(v.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(h.a)(this,a),(n=t.call(this,e)).handleTick=n.handleTick.bind(Object(d.a)(n)),n.setCurrent=n.setCurrent.bind(Object(d.a)(n)),n.state={current:null,layout:e.nodes.reduce((function(e,t){return e[t.id]={x:0,y:0},e}),{})},n}return Object(f.a)(a,[{key:"componentDidMount",value:function(){}},{key:"componentWillMount",value:function(){this.runForceSimulation(),this.simulation.on("tick",this.handleTick)}},{key:"componentWillUnmount",value:function(){this.simulation.on("tick",null)}},{key:"componentWillReceiveProps",value:function(e){this.props.tick!==e.tick&&this.updateForceSimulation()}},{key:"updateForceSimulation",value:function(){this.simulation.alpha(.2).restart(),this.simulation.nodes(this.props.nodes),this.simulation.force("link").links(this.props.edges)}},{key:"shouldComponentUpdate",value:function(e,t){return e.tick!==t.tick}},{key:"runForceSimulation",value:function(){var e=this.props,t=e.nodes,a=e.edges;(this.simulation=Object(g.c)(t).force("link",Object(g.b)().id((function(e){return e.id}))).force("collide",Object(g.a)((function(){return 1})).iterations(1).radius(9))).force("link").links(a).distance(25)}},{key:"handleTick",value:function(){var e=this.simulation,t=this.state.layout,a={};e.nodes().map((function(e){a[e.id]=e})),this.setState({layout:Object(s.a)({},t,{},a)})}},{key:"setCurrent",value:function(e){var t=this;return function(){t.setState({current:e})}}},{key:"render",value:function(){var e=this,t=this.props,a=t.nodes,n=(t.edges,t.width),r=t.height,o=t.onNodeClick,c=this.state,s=c.layout,l=c.current;return i.a.createElement("svg",{width:n,ref:function(t){return e.svgRef=t},height:r,style:{shapeRendering:"geometricPrecision"}},a.map((function(e,t){return i.a.createElement(w,Object.assign({key:t,node:e,layout:s,current:l,width:n,height:r,onNodeClick:o},e))})))}}]),a}(n.Component);R.defaultProps={width:900,height:600,nodes:[],edges:[]};var x=a(20),L=a(12),G=a.n(L);function T(e,t,a,n){return e.slice(Math.max(e.length-n,0)).reduce((function(e,n,i){return e.concat("".concat(i*t,", ").concat(-n*a))}),[]).join(" ")}function P(e){var t=e.width,a=e.height,n=e.xOffset,r=void 0===n?10:n,o=e.yOffset,c=void 0===o?17:o,s=e.data,l=void 0===s?[]:s,u=e.maxXEntries,m=void 0===u?100:u,h=a-50,f=Math.max.apply(Math,[h].concat(Object(x.a)(l.reduce((function(e,t){var a=t.points;return e.concat(a)}),[])))),d=h/f;return i.a.createElement(i.a.Fragment,null,i.a.createElement("span",{className:G.a.labelY},"population \u2192"),i.a.createElement("svg",{className:G.a.lineChart,width:t,height:a},i.a.createElement("g",{transform:"scale(1, ".concat(d,"), translate(0, ").concat((a-30)/d,")")},l.map((function(e,t){var a=e.points,n=e.color;return i.a.createElement("g",{key:"line-".concat(t),transform:"translate(".concat(r+5,", ").concat(1+c,")")},i.a.createElement("polyline",{points:T(a,2.5,1,m),stroke:n,fill:"transparent",strokeWidth:2}))})))),i.a.createElement("span",{className:G.a.labelX},"days since the first case \u2192"))}var B=a(8),D=a.n(B);function U(e){var t=e.simulationState,a=e.onSettingChange,n=e.onRestartButtonClick;return i.a.createElement("div",{className:D.a.container},i.a.createElement("div",{className:D.a.form},i.a.createElement("label",null,"Initial sick agents",i.a.createElement("br",null),i.a.createElement("input",{type:"range",onChange:a("initialSickAgents"),value:t.initialSickAgents,min:0,max:10})," ",i.a.createElement("span",{className:D.a.value},t.initialSickAgents)),i.a.createElement("label",null,"Agents per building ",i.a.createElement("br",null),i.a.createElement("input",{type:"range",onChange:a("agentsPerHouse"),value:t.agentsPerHouse,min:1,max:10})," ",i.a.createElement("span",{className:D.a.value},t.agentsPerHouse))),i.a.createElement("div",{className:D.a.footer},i.a.createElement("button",{onClick:n},"Restart the simulation")))}var H,W,F=a(11),K=(H={},Object(c.a)(H,0,[[1,0]]),Object(c.a)(H,2,[[1,2]]),Object(c.a)(H,1,[[.995,1],[.004,2],[.001,3]]),Object(c.a)(H,3,[[1,3]]),H),V=(W={},Object(c.a)(W,0,[[.3,1],[.7,0]]),Object(c.a)(W,2,[[1,2]]),Object(c.a)(W,1,[[1,1]]),Object(c.a)(W,3,[[1,3]]),W);function X(e,t){var a=e.location.split("-"),n=Object(l.a)(a,1)[0];if("house"===n&&Math.random()<.9)return"stay";var i,r=t[n];return(i=r)[Math.floor(Math.random()*i.length)]}function Y(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];S(e);var t=e.filter((function(e){return"venue"===e.type})),a=t.length;return fetch("https://raw.githubusercontent.com/eusim/coronavirus-simulation/master/data/country_centroids_az8.json").then((function(e){return e.json()})).then((function(e){console.log(JSON.stringify(e));for(var n=0,i=0;i<e.features.length&&n<a;i++)if("Europe"===e.features[i].properties.region_un&&("Country"===e.features[i].properties.type||"Sovereign country"===e.features[i].properties.type)&&"Russia"!==e.features[i].properties.admin){var r=t[n];r.fx=14*e.features[i].geometry.coordinates[0]+300,r.fy=14*-e.features[i].geometry.coordinates[1]+1100,-99==e.features[i].properties.iso_a2&&(e.features[i].properties.iso_a2="XK"),r.venue=e.features[i].properties.iso_a2,n++}})),e}var z=[{name:"house",members:function(e){return e.agentsPerHouse},isRoot:!0,count:function(e){return e.houses}}],q={house:["house","house","house","house","house","house","house","house"]};function J(e){var t=[],a=[];z.forEach((function(n){for(var i=n.name,r=n.members,o=(n.isRoot,n.count),c=(n.alignment,0),s=0;c<o(e);c++,s++){var l="".concat(i,"-").concat(c);if(t.push({type:"venue",venue:i,id:l,size:1}),r)for(var u=0;u<r(e);u++,s++){var m="".concat(i,"-").concat(c,"-").concat(u);t.push({type:"agent",location:l,base:l,id:m,size:1,state:0}),a.push({source:m,target:l})}}}));var n,i=y(t.filter((function(e){return"agent"===e.type})),e.initialSickAgents),r=Object(F.a)(i);try{for(r.s();!(n=r.n()).done;){n.value.state=1}}catch(o){r.e(o)}finally{r.f()}return{nodes:Y(t),edges:a}}function Z(e,t,a){z.find((function(e){return e.isRoot}));return t.filter((function(e){return"agent"===e.type})).forEach((function(e,n){var i,r=X(e,q),o=e.location.split("-");Object(l.a)(o,1)[0]===r||"base"===r&&e.location===e.base||"stay"===r||3!==e.state&&Q(t,a,e,"base"===r?t.find((function(t){return t.id===e.base})):(i=e,t.filter((function(e){return e.venue===r})).reduce((function(e,t){return C(i,t)<C(i,e)?t:e}))))})),{nodes:t=function(e,t){var a,n=Object(F.a)(e);try{var i=function(){var n=a.value;if("agent"!==n.type)return"continue";var i=e.find((function(e){var t=e.id;return n.location===t}));t.filter((function(e){return e.target.id===i.id})).map((function(e){return e.source})).forEach((function(e){e.id!==n.id&&(1===n.state&&(e.state=O(V[e.state])),e.state=O(K[e.state]))}))};for(n.s();!(a=n.n()).done;)i()}catch(r){n.e(r)}finally{n.f()}}(t,a),edges:a,state:Object(s.a)({},e,{tick:e.tick+1})}}function Q(e,t,a,n){var i=e.find((function(e){return e.id===a.location}));if(!n.locked&&!i.locked){t.map((function(e){e.source.id===a.id&&(e.target=n)}));a.location=n.id}}var $={tick:0,agentsPerHouse:9,houses:42,initialSickAgents:1},ee=J($);var te=function(){var e=Object(n.useState)($),t=Object(l.a)(e,2),a=t[0],r=t[1],o=Object(n.useState)(ee.nodes),u=Object(l.a)(o,2),h=u[0],f=u[1],d=Object(n.useState)(ee.edges),p=Object(l.a)(d,2),v=p[0],g=p[1],b=Object(n.useState)([]),E=Object(l.a)(b,2),_=E[0],k=E[1],y=Object(n.useState)([]),S=Object(l.a)(y,2),O=S[0],j=S[1],C=Object(n.useState)([]),A=Object(l.a)(C,2),I=A[0],M=A[1],N=Object(n.useState)(!0),w=Object(l.a)(N,2),x=w[0],L=w[1],G=Object(n.useRef)(null);return function(e,t){var a=Object(n.useRef)();Object(n.useEffect)((function(){a.current=e}),[e]),Object(n.useEffect)((function(){if(null!==t){var e=setInterval((function(){a.current()}),t);return function(){return clearInterval(e)}}}),[t])}((function(){if(!x){var e=Z(a,h,v),t=(e.nodes,e.edges,e.state);r(t),k(_.concat(h.filter((function(e){return 1===e.state})).length)),j(O.concat(h.filter((function(e){return 2===e.state})).length)),M(I.concat(h.filter((function(e){return 3===e.state})).length))}}),1e3),Object(n.useEffect)((function(){L(!1)}),[x]),i.a.createElement("div",{className:m.a.container},i.a.createElement("div",{className:m.a.header},i.a.createElement("a",{href:"/",style:{color:"gray",textDecoration:"none"}},"\u21b5 Other simulations"),i.a.createElement("h3",null,"Simulating coronavirus with the SIR model"),i.a.createElement("h2",null,"An experiment to analyse how a virus spread over a community")),i.a.createElement("div",{className:m.a.simulation},i.a.createElement("div",{className:m.a.samples},i.a.createElement("span",{className:m.a.sampleSusceptible},"Susceptible"),i.a.createElement("span",{className:m.a.sampleInfected},"Infected"),i.a.createElement("span",{className:m.a.sampleRecovered},"Recovered"),i.a.createElement("i",null,"Click on a building to lock it (quarantine)")),!x&&i.a.createElement(R,{width:110*Math.round(h.filter((function(e){return"venue"===e.type})).length/6),height:700,tick:a.tick,nodes:h,edges:v,onNodeClick:function(e){return function(){var t=h.find((function(t){var a=t.id;return e===a}));"venue"===t.type&&(t.locked=!t.locked)}},ref:G})),i.a.createElement("div",{className:m.a.section},i.a.createElement("div",{className:m.a.stats},i.a.createElement("h3",null,"Stats"),i.a.createElement("div",{className:m.a.population},"POPULATION: ",h.filter((function(e){return"agent"===e.type})).length," ",i.a.createElement("br",null),"DEAD: ",h.filter((function(e){return 3===e.state})).length," ",i.a.createElement("br",null),"RECOVERED: ",h.filter((function(e){return 2===e.state})).length," ",i.a.createElement("br",null),"SICK: ",h.filter((function(e){return 1===e.state})).length," ",i.a.createElement("br",null)),i.a.createElement(P,{width:300,height:270,data:[{color:"red",points:_},{color:"green",points:O},{color:"black",points:I}]})),i.a.createElement("div",{className:m.a.simulationSettings},i.a.createElement("h3",null,"Settings"),i.a.createElement("div",{className:m.a.simulationInfo},"Click on a building on the map to make it quarantined."),i.a.createElement(U,{simulationState:a,onSettingChange:function(e){return function(t){r(Object(s.a)({},a,Object(c.a)({},e,t.target.value)))}},onRestartButtonClick:function(){var e=J(a),t=e.nodes,n=e.edges;L(!0),f(t),g(n),M([]),j([]),k([]),r(Object(s.a)({},a,{tick:0}))}}))),i.a.createElement("div",{className:m.a.pageInfo},i.a.createElement("ins",{className:"adsbygoogle",style:{display:"block",textAlign:"center"},"data-ad-layout":"in-article","data-ad-format":"fluid","data-ad-client":"ca-pub-5587173855104127","data-ad-slot":"8487596319"}),i.a.createElement("div",{className:m.a.section},i.a.createElement("h1",null,"What is this?"),i.a.createElement("p",null,"This is a simulation of how a virus spread of the population. The simulation is heavily inspired by the SIR model. SIR is a technique used to simplify the mathematical modelling of infectious disase."),i.a.createElement("p",null,"In the SIR model, we have three different states of each agent (a person). The first state is",i.a.createElement("i",null," SUSCEPTIBLE"),", second one is ",i.a.createElement("i",null," SICK"),", and the last one is",i.a.createElement("i",null," RECOVERED"),". We have also a ",i.a.createElement("i",null," DEAD")," state in this simulation."),i.a.createElement("h1",null,"How does it work?"),i.a.createElement("p",null,"Every agent starts with the `SUSCEPTIBLE` state in the simulation, except a few of them. Some of the agents are on the `SICK` state at the very beginning. Over the time, sick agents spread the virus to rest of the population and the other agents get sick as well. After the infection, they switch into a recovered or a dead state based on some probabilistic values."),i.a.createElement("p",null,"The probabilistic values are defined in a markov-chain concept. Markov chain is a stochastic model to describe a sequence of possible events that can occur in the future."),i.a.createElement("h1",null,"How does a probabilistic model look like?"),i.a.createElement("p",null,"We're using a markov graph to define a probabilistic transition. We can simply say that markov chain is a graph of all the possible state transitions of an individual node."),i.a.createElement("h1",null,"I would like to discover more:"),i.a.createElement("p",null,"This is an MIT-licensed open-source project, you can find the source code on github. Feel free to copy, use or modify it for your own simulations."),i.a.createElement("p",null,i.a.createElement("a",{href:"https://github.com/eusim/coronavirus-simulation"},"https://github.com/eusim/coronavirus-simulation")," which is based on",i.a.createElement("a",{href:"https://twitter.com/fthrkl"},"@fthrkl"),"'s",i.a.createElement("br",null),i.a.createElement("a",{href:"https://github.com/fatiherikli/coronavirus-simulation"},"https://github.com/fatiherikli/coronavirus-simulation")),i.a.createElement("p",{style:{marginBottom:"4em"}},"Stay safe! ",i.a.createElement("br",null)," "))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(te,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},3:function(e,t,a){e.exports={container:"App_container__1MQN3",header:"App_header__3ZZ1n",simulationContainer:"App_simulationContainer__23iFm",simulation:"App_simulation__1Y9Gr",section:"App_section__1OL6S",simulationSettings:"App_simulationSettings__txA-R",stats:"App_stats__2fMs7",population:"App_population__3MVPW",simulationInfo:"App_simulationInfo__1KRFk",pageInfo:"App_pageInfo__2E9cf",samples:"App_samples__2e7V-",sampleSusceptible:"App_sampleSusceptible__2olEO",sampleInfected:"App_sampleInfected__1l1Pi",sampleRecovered:"App_sampleRecovered__33NzV"}},5:function(e,t,a){e.exports={node:"Graph_node__2LUmU",venue:"Graph_venue__1yeeL",hospital:"Graph_hospital__2-HM5",teatr:"Graph_teatr__3zcOH",station:"Graph_station__3oWAU",supermarket:"Graph_supermarket__x5o1m",susceptible:"Graph_susceptible__2UC5Q",dead:"Graph_dead__aGtk-",sick:"Graph_sick__2ig0f",recovered:"Graph_recovered__3crc2",lockedSymbol:"Graph_lockedSymbol__1OEeZ"}},8:function(e,t,a){e.exports={container:"SimulationSettings_container__vY4rL",form:"SimulationSettings_form__E6YUW",value:"SimulationSettings_value__1sPd7",footer:"SimulationSettings_footer__1GRqa"}}},[[23,1,2]]]);
//# sourceMappingURL=main.bf1e7b06.chunk.js.map